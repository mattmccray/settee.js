(function(){var e,t,n,r,i,u,o,l,f,s,p,c,a,h,d,y,g,x,m,v,b,_,w,q,O,S,k,A,j,N,E={}.hasOwnProperty;if(typeof module==="undefined"||module===null){o=this;a=o.settee}g=Array.prototype.slice;f=Array.prototype.forEach;p=Array.prototype.map;s=Array.isArray;c=String.prototype.trim;d=/([\w\-_\.]*)="([\w\-_:@\. ]*)"/;t=/([\w\-_\.]*)=([\w\-_:@\.]*)/;l=/(#[\w\-_]*)/;u=function(e){return e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")};O=function(e,t,n){var r;r=[];if(e===null){return r}if(p&&e.map===p){return e.map(t,n)}_(e,function(e,i,u){return r[r.length]=t.call(n,e,i,u)});if(e.length===+e.length){r.length=e.length}return r};_=function(e,t,n){var r,i,u,o,l;if(e===null){return}if(f&&e.forEach===f){return e.forEach(t,n)}else if(e.length===+e.length){for(r=o=0,l=e.length;o<l;r=++o){i=e[r];if(r in e&&t.call(n,i,r,e)===breaker){return}}}else{for(u in e){if(!E.call(e,u))continue;i=e[u];if(t.call(n,i,u,e)===breaker){return}}}};N=function(e,t){if(e===null){return""}if(!t&&c){return c.call(e)}t=t?u(t):"\\s";e.replace(new RegExp("^["+characters+"]+|["+characters+"]+$","g"),"");return e.replace(/^[#{char}]+|[#{char}]+$/g,"")};q=function(e){return typeof e==="string"};w=s||function(e){return!!(e&&e.concat&&e.unshift&&!e.callee)};S=function(e,n){var r,i,u,o,l;if(n==null){n=true}if(q(e)){if(d.test(e)){o=e.match(d),r=o[0],i=o[1],u=o[2];if(n){return""+i+'="'+u+'"'}return{key:i,value:u}}else if(t.test(e)){l=e.match(t),r=l[0],i=l[1],u=l[2];if(n){return""+i+'="'+u+'"'}return{key:i,value:u}}else{return false}}else{return false}};v=function(e){if(e[0]==="@"||e[0]===":"){return"this.get('"+e.substring(1)+"')"}else{return e}};j=function(){var e,t,n,r,i;if(this.text.length===0){return""}r=0;n=1;e=0;t=this.text.charAt(0);if(t==="("||t===")"){n=1;this.balanced+=t==="("?1:-1}else if(t==='"'){n=this.text.search(/[^\\]"/)+1;e=1}else if(t==="'"){n=this.text.search(/[^\\]'/)+1;e=1}else{n=this.text.search(/[ \n)]/)}if(n<1){n=this.text.length}i=this.text.substring(r,n);this.text=N(this.text.substring(n+e));return i};k=function(){var e,t,n;t=[];n=j.apply(this);while(n!==")"&&n!==""){e=n==="("?k.apply(this):n;t.push(e);n=j.apply(this)}return t};b=function(e){var t,n,r;r={text:N(e),balanced:0};t=["list"];while(r.text.length){n=k.apply(r);t=t.concat(n)}return[t,r]};h=function(e,t){var n,r,i;i=b(e),n=i[0],r=i[1];return n.pop()};if(typeof exports!=="undefined"&&exports!==null){exports.parse_source=h}else{this.parse_source=h}m=function(e,t){var n,r,i,u,o,f,s,p,c,a,h;u=[];f=e[0];if(l.test(f)){i=f.match(l)[0].substring(1);f=f.replace(l,"");if(f===""){f="div"}}if(f.indexOf(".")>=0){if(f==="."){f=".";u.push(f);if(i){u.push("id="+i)}}else{o=f.split(".");f=o.shift();if(f===""){f="div"}u.push(f);if(i){u.push("id="+i)}for(p=0,a=o.length;p<a;p++){n=o[p];u.push("class="+n)}}}else{u.push(f);if(i){u.push("id="+i)}}for(r=c=0,h=e.length;c<h;r=++c){s=e[r];if(r>0){if(w(s)){u.push(m(s,t))}else{u.push(s)}}}return u};if(typeof exports!=="undefined"&&exports!==null){exports.translate=m}else{this.translate=m}n=function(e,t){var r,i,u,o,l,f,s,p,c,a;l=[];u={};f=e.shift();for(c=0,a=e.length;c<a;c++){s=e[c];if(w(s)){l.push(n(s,t))}else{if(r=S(s,false)){o=r.key;p=v(r.value);if(u[o]){u[o]+=" "+p}else{u[o]=p}}else if(s[0]==='"'||s[0]==="'"){l.push(JSON.stringify(s.substring(1)))}else if(s[0]==="@"||s[0]===":"){l.push(v(s))}else{l.push(JSON.stringify(s))}}}i="";for(o in u){if(!E.call(u,o))continue;p=u[o];i+=String(o).indexOf("this.")!==0?JSON.stringify(o):o;i+=":";i+=String(p).indexOf("this.")!==0?JSON.stringify(p):p;i+=","}return""+t+"('"+f+"', { "+i.substr(0,i.length-1)+" }, ["+l.join(", ")+"])"};if(typeof exports!=="undefined"&&exports!==null){exports.code_to_source=n}else{this.code_to_source=n}r=function(e,t){var r,i;r="s";i=n(e,r);return new Function(r,"return "+i+";")};if(typeof exports!=="undefined"&&exports!==null){exports.compile=r}else{this.compile=r}i=function(){function e(e){this.ctx=e}e.prototype.get=function(e){var t,n,r,i;i=e.split(".");n=i.shift();t=this.ctx[n];while(i.length&&t!=null){r=i.shift();t=t[r];if(t!=null){n=r}}return t||""};e.prototype.has=function(e){return this.get(e)&&this.get(e)!==""};return e}();if(typeof module!=="undefined"&&module!==null){module.exports=i}else{this.context=i}x=function(){var e;function t(){}t.prototype["."]=function(e,t,n){return n.join("")};t.prototype["+"]=t.prototype["."];t.prototype["if"]=function(e,t,n){var r;r=n.shift();if(r){return n.join("")}else{return""}};t.prototype.unless=function(e,t,n){var r;r=n.shift();if(!r){return n.join("")}else{return""}};t.prototype.ifelse=function(e,t,n){if(n[0]){return n[1]}else{return n[2]}};t.prototype.eq=function(e,t,n){return n[0]===n[1]};t.prototype["is"]=t.prototype.eq;t.prototype["="]=t.prototype.eq;t.prototype.not=function(e,t,n){return!n[0]};t.prototype["!"]=t.prototype.eq;t.prototype.neq=function(e,t,n){return n[0]!==n[1]};t.prototype["isnt"]=t.prototype.neq;t.prototype["!="]=t.prototype.neq;e=new t;t.define=function(t,n){return e[t]=n};t.undefine=function(t){return delete e[t]};t.builder=function(t,n,r){var i,u,o;if(n==null){n={}}if(r==null){r=[]}if(e[t]){return e[t](t,n,r)}else{i="";for(u in n){if(!E.call(n,u))continue;o=n[u];i+=" "+u+'="'+o+'"'}return"<"+(t+i)+">"+r.join("")+"</"+t+">"}};return t}();if(typeof module!=="undefined"&&module!==null){module.exports=x}else{this.tag=x}e="0.6.0";if(typeof module!=="undefined"&&module!==null){A=require("./parser"),h=A.parse_source,m=A.translate,r=A.compile,q=A._isString,w=A._isArray;i=require("./context");x=require("./tag")}y=function(e){var t;t=typeof e==="string"?m(h(e)):e;return y.compile(t)};y.render=function(e,t){if(t==null){t={}}return y(e)(t)};y.to_html=y.render;y.compile=function(e,t){var n;if(t==null){t=true}n=typeof e==="function"?e:r(e);if(!t){return n}return function(e){var t;if(e==null){e={}}t=new i(e);return n.call(t,x.builder)}};y.parse=function(e){var t;t=h(e);return m(t)};y.precompile=function(e){var t,n;t=y.parse(e);n=y.compile(t,false);return n};y.define=function(e,t){var n;if(q(t||t.length===1)){n=y(t);t=function(e){return function(t,n,r){var i,u,o,l,f,s;i=r.join("");u={tagName:t,attrs:n,blocks:i,yield:i};for(l=f=0,s=r.length;f<s;l=++f){o=r[l];u["block"+(l+1)]=o}return e(u)}}(n)}x.define(e,t);return y};y.undefine=function(e){x.undefine(e);return y};y.noConflict=function(){if(a!=null){o.settee=a}else{delete o.settee}return y};y.tag_builder=x.builder;y.version=e;if(typeof module!=="undefined"&&module!==null){module.exports=y}else{this.settee=y}}).call(this);