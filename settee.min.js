(function(){var e,t,r,n,i,u,o,l,s,f,p,c,a,h,y,d,g,x,m,v,_,b,w,q,O,S,k,A,j,N,E={}.hasOwnProperty;if(typeof module==="undefined"||module===null){o=this;a=o.settee}g=Array.prototype.slice;s=Array.prototype.forEach;p=Array.prototype.map;f=Array.isArray;c=String.prototype.trim;y=/([\w\-_\.]*)="([\w\-_:@\. ]*)"/;t=/([\w\-_\.]*)=([\w\-_:@\.]*)/;l=/(#[\w\-_]*)/;u=function(e){return e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")};O=function(e,t,r){var n;n=[];if(e===null){return n}if(p&&e.map===p){return e.map(t,r)}b(e,function(e,i,u){return n[n.length]=t.call(r,e,i,u)});if(e.length===+e.length){n.length=e.length}return n};b=function(e,t,r){var n,i,u,o,l;if(e===null){return}if(s&&e.forEach===s){return e.forEach(t,r)}else if(e.length===+e.length){for(n=o=0,l=e.length;o<l;n=++o){i=e[n];if(n in e&&t.call(r,i,n,e)===breaker){return}}}else{for(u in e){if(!E.call(e,u))continue;i=e[u];if(t.call(r,i,u,e)===breaker){return}}}};N=function(e,t){if(e===null){return""}if(!t&&c){return c.call(e)}t=t?u(t):"\\s";e.replace(new RegExp("^["+characters+"]+|["+characters+"]+$","g"),"");return e.replace(/^[#{char}]+|[#{char}]+$/g,"")};q=function(e){return typeof e==="string"};w=f||function(e){return!!(e&&e.concat&&e.unshift&&!e.callee)};S=function(e,r){var n,i,u,o,l;if(r==null){r=true}if(q(e)){if(y.test(e)){o=e.match(y),n=o[0],i=o[1],u=o[2];if(r){return""+i+'="'+u+'"'}return{key:i,value:u}}else if(t.test(e)){l=e.match(t),n=l[0],i=l[1],u=l[2];if(r){return""+i+'="'+u+'"'}return{key:i,value:u}}else{return false}}else{return false}};v=function(e){if(e[0]==="@"||e[0]===":"){return"this.get('"+e.substring(1)+"')"}else{return e}};j=function(){var e,t,r,n,i;if(this.text.length===0){return""}n=0;r=1;e=0;t=this.text.charAt(0);if(t==="("||t===")"){r=1;this.balanced+=t==="("?1:-1}else if(t==='"'){r=this.text.search(/[^\\]"/)+1;e=1}else if(t==="'"){r=this.text.search(/[^\\]'/)+1;e=1}else{r=this.text.search(/[ \n)]/)}if(r<1){r=this.text.length}i=this.text.substring(n,r);this.text=N(this.text.substring(r+e));return i};k=function(){var e,t,r;t=[];r=j.apply(this);while(r!==")"&&r!==""){e=r==="("?k.apply(this):r;t.push(e);r=j.apply(this)}return t};_=function(e){var t,r,n;n={text:N(e),balanced:0};t=["list"];while(n.text.length){r=k.apply(n);t=t.concat(r)}return[t,n]};h=function(e,t){var r,n,i;i=_(e),r=i[0],n=i[1];return r.pop()};if(typeof exports!=="undefined"&&exports!==null){exports.parse_source=h}else{this.parse_source=h}m=function(e,t){var r,n,i,u,o,s,f,p,c,a,h;u=[];s=e[0];if(l.test(s)){i=s.match(l)[0].substring(1);s=s.replace(l,"");if(s===""){s="div"}}if(s.indexOf(".")>=0){if(s==="."){s=".";u.push(s);if(i){u.push("id="+i)}}else{o=s.split(".");s=o.shift();if(s===""){s="div"}u.push(s);if(i){u.push("id="+i)}for(p=0,a=o.length;p<a;p++){r=o[p];u.push("class="+r)}}}else{u.push(s);if(i){u.push("id="+i)}}for(n=c=0,h=e.length;c<h;n=++c){f=e[n];if(n>0){if(w(f)){u.push(m(f,t))}else{u.push(f)}}}return u};if(typeof exports!=="undefined"&&exports!==null){exports.translate=m}else{this.translate=m}r=function(e,t){var n,i,u,o,l,s,f,p,c,a;l=[];u={};s=e.shift();for(c=0,a=e.length;c<a;c++){f=e[c];if(w(f)){l.push(r(f,t))}else{if(n=S(f,false)){o=n.key;p=v(n.value);if(u[o]){u[o]+=" "+p}else{u[o]=p}}else if(f[0]==='"'||f[0]==="'"){l.push(JSON.stringify(f.substring(1)))}else if(f[0]==="@"||f[0]===":"){l.push(v(f))}else{l.push(JSON.stringify(f))}}}i="";for(o in u){if(!E.call(u,o))continue;p=u[o];i+=String(o).indexOf("this.")!==0?JSON.stringify(o):o;i+=":";i+=String(p).indexOf("this.")!==0?JSON.stringify(p):p;i+=","}if(s==="loop"||s==="each"){return""+t+"('"+s+"', { "+i.substr(0,i.length-1)+" }, "+l.shift()+", function(){return ["+l.join(", ")+"]; })"}else{return""+t+"('"+s+"', { "+i.substr(0,i.length-1)+" }, ["+l.join(", ")+"])"}};if(typeof exports!=="undefined"&&exports!==null){exports.code_to_source=r}else{this.code_to_source=r}n=function(e,t){var n,i;n="s";i=r(e,n);return new Function(n,"return "+i+";")};if(typeof exports!=="undefined"&&exports!==null){exports.compile=n}else{this.compile=n}i=function(){function e(e){this.ctx=e}e.prototype.get=function(e){var t,r,n,i;i=e.split(".");r=i.shift();t=this.ctx[r];while(i.length&&t!=null){n=i.shift();t=t[n];if(t!=null){r=n}}return t||""};e.prototype.has=function(e){return this.get(e)&&this.get(e)!==""};return e}();if(typeof module!=="undefined"&&module!==null){module.exports=i}else{this.context=i}x=function(){var e;function t(){}t.prototype["."]=function(e,t,r){return r.join("")};t.prototype["+"]=t.prototype["."];t.prototype["if"]=function(e,t,r){var n,i,u;n=r.shift();if(n){return(i=r[0])!=null?i:""}else{return(u=r[1])!=null?u:""}};t.prototype.ifelse=t.prototype["if"];t.prototype.unless=function(e,t,r){var n,i,u;n=r.shift();if(!n){return(i=r[0])!=null?i:""}else{return(u=r[1])!=null?u:""}};t.prototype.eq=function(e,t,r){return r[0]===r[1]};t.prototype["is"]=t.prototype.eq;t.prototype["="]=t.prototype.eq;t.prototype.not=function(e,t,r){return!r[0]};t.prototype["!"]=t.prototype.eq;t.prototype.loop=function(e,t,r,n){var u,o,l,s,f,p;u=[];o=new i({items:r});for(l=f=0,p=r.length;f<p;l=++f){s=r[l];o.ctx.item=s;o.ctx.index=l;u.push(n.call(o))}return u.join("")};t.prototype.each=t.prototype.loop;t.prototype.neq=function(e,t,r){return r[0]!==r[1]};t.prototype["isnt"]=t.prototype.neq;t.prototype["!="]=t.prototype.neq;e=new t;t.define=function(t,r){return e[t]=r};t.undefine=function(t){return delete e[t]};t.builder=function(t,r,n){var i,u,o;if(r==null){r={}}if(n==null){n=[]}if(e[t]){return e[t].apply(e[t],arguments)}else{i="";for(u in r){if(!E.call(r,u))continue;o=r[u];i+=" "+u+'="'+o+'"'}return"<"+(t+i)+">"+n.join("")+"</"+t+">"}};return t}();if(typeof module!=="undefined"&&module!==null){module.exports=x}else{this.tag=x}e="0.7.0";if(typeof module!=="undefined"&&module!==null){A=require("./parser"),h=A.parse_source,m=A.translate,n=A.compile,q=A._isString,w=A._isArray;i=require("./context");x=require("./tag")}d=function(e){var t;t=typeof e==="string"?m(h(e)):e;return d.compile(t)};d.render=function(e,t){if(t==null){t={}}return d(e)(t)};d.to_html=d.render;d.compile=function(e,t){var r;if(t==null){t=true}r=typeof e==="function"?e:n(e);if(!t){return r}return function(e){var t;if(e==null){e={}}t=new i(e);return r.call(t,x.builder)}};d.parse=function(e){var t;t=h(e);return m(t)};d.precompile=function(e){var t,r;t=d.parse(e);r=d.compile(t,false);return r};d.define=function(e,t){var r;if(q(t||t.length===1)){r=d(t);t=function(e){return function(t,r,n){var i,u,o,l,s,f;i=n.join("");u={tagName:t,attrs:r,blocks:i,yield:i};for(l=s=0,f=n.length;s<f;l=++s){o=n[l];u["block"+(l+1)]=o}return e(u)}}(r)}x.define(e,t);return d};d.undefine=function(e){x.undefine(e);return d};d.noConflict=function(){if(a!=null){o.settee=a}else{delete o.settee}return d};d.tag_builder=x.builder;d.version=e;if(typeof module!=="undefined"&&module!==null){module.exports=d;module.exports.__express=require("./express")}else{this.settee=d}}).call(this);