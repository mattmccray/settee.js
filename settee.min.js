// Settee v0.5.1 -- http://darthapo.github.com/settee.js/
(function(){var H,r,s,I,p,j,J,o,q,t,K,u,v,w,L,x,k,Q,y,z,A,M,N,B,C,R,O,D,E,F,G={}.hasOwnProperty;H='0.5.1';o=this;w=o.settee;Q=Array.prototype.slice;t=Array.prototype.forEach;u=Array.prototype.map;K=Array.isArray;v=String.prototype.trim;x=/([\w\-_\.]*)="([\w\-_:@\. ]*)"/;r=/([\w\-_\.]*)=([\w\-_:@\.]*)/;q=/(#[\w\-_]*)/;J=function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,'\\$1')};R=function(c,e,f){var g;g=[];if(c===null){return g}if(u&&c.map===u){return c.map(e,f)}N(c,function(a,d,b){return g[g.length]=e.call(f,a,d,b)});if(c.length===+c.length){g.length=c.length}return g};N=function(a,d,b){var c,e,f,g,h;if(a===null){return}if(t&&a.forEach===t){return a.forEach(d,b)}else if(a.length===+a.length){for(c=g=0,h=a.length;g<h;c=++g){e=a[c];if(c in a&&d.call(b,e,c,a)===breaker){return}}}else{for(f in a){if(!G.call(a,f))continue;e=a[f];if(d.call(b,e,f,a)===breaker){return}}}};F=function(a,d){if(a===null){return""}if(!d&&v){return v.call(a)}d=d?J(d):'\\s';a.replace(new RegExp('\^['+characters+']+|['+characters+']+$','g'),'');return a.replace(/^[#{char}]+|[#{char}]+$/g,'')};C=function(a){return typeof a==='string'};B=K||function(a){return!!(a&&a.concat&&a.unshift&&!a.callee)};O=function(a,d){var b,c,e,f,g;if(d==null){d=true}if(C(a)){if(x.test(a)){f=a.match(x),b=f[0],c=f[1],e=f[2];if(d){return""+c+"=\""+e+"\""}return{key:c,value:e}}else if(r.test(a)){g=a.match(r),b=g[0],c=g[1],e=g[2];if(d){return""+c+"=\""+e+"\""}return{key:c,value:e}}else{return false}}else{return false}};A=function(a){if(a[0]==='@'||a[0]===':'){return"this.get('"+(a.substring(1))+"')"}else{return a}};E=function(){var a,d,b,c,e;if(this.text.length===0){return""}c=0;b=1;a=0;d=this.text.charAt(0);if(d==='('||d===')'){b=1;this.balanced+=d==='('?1:-1}else if(d==='"'){b=this.text.search(/[^\\]"/)+1;a=1}else if(d==="'"){b=this.text.search(/[^\\]'/)+1;a=1}else{b=this.text.search(/[ \n)]/)}if(b<1){b=this.text.length}e=this.text.substring(c,b);this.text=F(this.text.substring(b+a));return e};D=function(){var a,d,b;d=[];b=E.apply(this);while(b!==')'&&b!==""){a=b==='('?D.apply(this):b;d.push(a);b=E.apply(this)}return d};M=function(a){var d,b,c;c={text:F(a),balanced:0};d=['list'];while(c.text.length){b=D.apply(c);d=d.concat(b)}return[d,c]};L=function(a,d){var b,c,e;e=M(a),b=e[0],c=e[1];return b.pop()};z=function(a,d){var b,c,e,f,g,h,i,l,m,n,P;f=[];h=a[0];if(q.test(h)){e=h.match(q)[0].substring(1);h=h.replace(q,'');if(h===''){h='div'}}if(h.indexOf('.')>=0){if(h==='.'){h='.';f.push(h);if(e){f.push("id="+e)}}else{g=h.split('.');h=g.shift();if(h===''){h='div'}f.push(h);if(e){f.push("id="+e)}for(l=0,n=g.length;l<n;l++){b=g[l];f.push("class="+b)}}}else{f.push(h);if(e){f.push("id="+e)}}for(c=m=0,P=a.length;m<P;c=++m){i=a[c];if(c>0){if(B(i)){f.push(z(i,d))}else{f.push(i)}}}return f};s=function(a,d){var b,c,e,f,g,h,i,l,m,n;g=[];e={};h=a.shift();for(m=0,n=a.length;m<n;m++){i=a[m];if(B(i)){g.push(s(i,d))}else{if(b=O(i,false)){f=b.key;l=A(b.value);if(e[f]){e[f]+=" "+l}else{e[f]=l}}else if(i[0]==='"'||i[0]==="'"){g.push(JSON.stringify(i.substring(1)))}else if(i[0]==='@'||i[0]===":"){g.push(A(i))}else{g.push(JSON.stringify(i))}}}c='';for(f in e){if(!G.call(e,f))continue;l=e[f];c+=String(f).indexOf('this.')!==0?JSON.stringify(f):f;c+=':';c+=String(l).indexOf('this.')!==0?JSON.stringify(l):l;c+=","}return""+d+"('"+h+"', { "+(c.substr(0,c.length-1))+" }, ["+(g.join(', '))+"])"};I=function(a,d){var b,c;b='b';c=s(a,b);return new Function(b,"return "+c+";")};j={".":function(a,d,b){return b.join('')},"if":function(a,d,b){var c;c=b.shift();if(c){return b.join('')}else{return''}},"unless":function(a,d,b){var c;c=b.shift();if(!c){return b.join('')}else{return''}},"ifelse":function(a,d,b){if(b[0]){return b[1]}else{return b[2]}},"eq":function(a,d,b){return b[0]===b[1]},"neq":function(a,d,b){return b[0]!==b[1]}};j['is']=j['eq'];j['=']=j['eq'];j['isnt']=j['neq'];j['!=']=j['neq'];j['+']=j['.'];y=function(a,d,b){var c,e,f;if(d==null){d={}}if(b==null){b=[]}if(j[a]){return j[a](a,d,b)}else{c='';for(e in d){if(!G.call(d,e))continue;f=d[e];c+=" "+e+"=\""+f+"\""}return"<"+(a+c)+">"+(b.join(''))+"</"+a+">"}};p=function(a){this.ctx=a};p.prototype.get=function(a){var d,b,c,e;e=a.split('.');b=e.shift();d=this.ctx[b];while(e.length&&(d!=null)){c=e.shift();d=d[c];if(d){b=c}}return d||''};p.prototype.has=function(a){return this.get(a)&&this.get(a)!==''};k=function(b){var c,e;c=L(b);c=z(c);e=I(c);return function(a){var d;if(a==null){a={}}d=new p(a);return e.call(d,y)}};k.to_html=function(a,d,b){if(d==null){d={}}return k(a)(d)};k.define=function(l,m){var n;if(C(m)){n=k(m);m=(function(i){return function(a,d,b){var c,e,f,g,h;c={blocks:b.join(''),"yield":b.join('')};for(f=g=0,h=b.length;g<h;f=++g){e=b[f];c["block"+(f+1)]=e}return i(c)}})(n)}j[l]=m;return k};k.undefine=function(a){if(j[a]){delete j[a]}return k};k.noConflict=function(){if(w){o.settee=w}else{delete o.settee}return k};k.tag_builder=y;k.version=H;if((typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null){module.exports.settee=k}else{o.settee=k}}).call(this);